<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
<meta http-equiv="Content-Style-Type" content="text/css">
<title>AKARI Install manual</title>
<link rel="stylesheet" href="http://tomoyo.sourceforge.jp/tomoyo.css" media="all" type="text/css">
</head>
<body>
<p style="text-align:right;"><a href="install.html.ja">Japanese Page</a></p>
<p style="text-align:right;">Last modified: $Date$</p>
<h1>Phase 1: Installing kernel module and tools.</h1>

<p>This page describes how to install the AKARI's kernel module and userland tools.</p>

<hr>

<h2>Step 1: Installing kernel module</h2>

<p>Install packages required for compiling the kernel modules and tools.</p>

<table border="1">
<tr><td>RedHat distributions</td><td>
# yum -y install gcc ncurses-devel wget make
</td></tr>
<tr><td>Debian distributions</td><td>
# apt-get -y install gcc libncurses-dev wget make
</td></tr>
</table>

<p>Next, install a kernel development package, and goto the extracted directory.</p>

<table border="1">
<tr><td>RedHat distributions</td><td>
# VERSION=`uname -r`<br>
# yum -y install kernel-devel-${VERSION}<br>
# cd /usr/src/kernels/${VERSION}*/
</td></tr>
<tr><td>Debian distributions</td><td>
# VERSION=`uname -r`<br>
# apt-get -y install linux-headers-${VERSION}<br>
# cd /usr/src/linux-headers-${VERSION}/
</td></tr>
</table>

<p>Next, run the following commands in order to install AKARI's kernel module.</p>

<table border="1">
<tr><td>
# wget -O akari-1.0.30-20140915.tar.gz 'http://sourceforge.jp/frs/redir.php?f=/akari/49272/akari-1.0.30-20140915.tar.gz'<br>
# wget -O akari-1.0.30-20140915.tar.gz.asc 'http://sourceforge.jp/frs/redir.php?f=/akari/49272/akari-1.0.30-20140915.tar.gz.asc'<br>
# gpg akari-1.0.30-20140915.tar.gz.asc<br>
# tar -zxf akari-1.0.30-20140915.tar.gz<br>
# make SUBDIRS=$PWD/akari modules<br>
# make SUBDIRS=$PWD/akari modules_install<br>
# depmod ${VERSION}
</td></tr>
</table>

<p>If you encountered one of</p>

<pre>
This module supports only 2.6.0 and later kernels.
You must choose CONFIG_SECURITY=y for building this module.
You must choose CONFIG_KALLSYMS=y for building this module.
You must choose CONFIG_PROC_FS=y for building this module.
You must choose CONFIG_MODULES=y for building this module.
</pre>

<p>errors, you can't use AKARI for your kernel. For other errors, please contact the author ( penguin-kernel&#64;I-love.SAKURA.ne.jp ).</p>

<p>If you are interested in what functionality and syntax are supported for your kernel, see <a href="comparison.html.en">AKARI / TOMOYO functionality comparison table</a>.</p>

<hr>

<h2>Step 2: Installing tools</h2>

<p>Next, run the following commands in order to install AKARI's tools.</p>

<table border="1">
<tr><td>
# cd /tmp/<br>
# wget -O ccs-tools-1.8.1-20110401.tar.gz 'http://sourceforge.jp/frs/redir.php?f=/tomoyo/49693/ccs-tools-1.8.1-20110401.tar.gz'<br>
# wget -O ccs-tools-1.8.1-20110401.tar.gz.asc 'http://sourceforge.jp/frs/redir.php?f=/tomoyo/49693/ccs-tools-1.8.1-20110401.tar.gz.asc'<br>
# gpg ccs-tools-1.8.1-20110401.tar.gz.asc<br>
# tar -zxf ccs-tools-1.8.1-20110401.tar.gz<br>
# cd ccstools/<br>
# make -s<br>
# make -s install<br>
# ldconfig
</td></tr>
</table>

<hr>

<h2>Step 3: Updating boot configuration</h2>

<p>Add init=/sbin/ccs-init parameter to the kernel command line. An example is shown below.</p>

<table border="1">
<tr><td>Before</td><td>
title CentOS (2.6.18-238.5.1.el5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;root (hd0,0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kernel /boot/vmlinuz-2.6.18-238.5.1.el5 ro root=LABEL=/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;initrd /boot/initrd-2.6.18-238.5.1.el5.img
</td></tr>
<tr><td>After</td><td>
title CentOS (2.6.18-238.5.1.el5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;root (hd0,0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kernel /boot/vmlinuz-2.6.18-238.5.1.el5 ro root=LABEL=/ init=/sbin/ccs-init<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;initrd /boot/initrd-2.6.18-238.5.1.el5.img
</td></tr>
</table>

<p>Although AKARI is a LSM module, AKARI can coexist with other LSM modules. But you need to add selinux=0 like below if you disable SELinux by specifying SELINUX=disabled in /etc/selinux/config . This is because /sbin/init unregisters LSM hooks which AKARI module depends on if SELINUX=disabled is specified in /etc/selinux/config .</p>

<table border="1">
<tr><td>Before</td><td>
title CentOS (2.6.18-238.5.1.el5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;root (hd0,0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kernel /boot/vmlinuz-2.6.18-238.5.1.el5 ro root=LABEL=/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;initrd /boot/initrd-2.6.18-238.5.1.el5.img
</td></tr>
<tr><td>After</td><td>
title CentOS (2.6.18-238.5.1.el5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;root (hd0,0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kernel /boot/vmlinuz-2.6.18-238.5.1.el5 ro root=LABEL=/ selinux=0 init=/sbin/ccs-init<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;initrd /boot/initrd-2.6.18-238.5.1.el5.img
</td></tr>
</table>

<p>To uninstall AKARI, remove init=/sbin/ccs-init parameter from the kernel command line and reboot the system.</p>

<hr>

<p><a href="index.html.en">Return to index page.</a></p>
<p><a href="http://sourceforge.jp/"><img src="http://sourceforge.jp/sflogo.php?group_id=5310" width="96" height="31" alt="sflogo.php" title="SourceForge.jp"></a></p>
</body>
</html>
