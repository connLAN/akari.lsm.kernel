<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
<meta http-equiv="Content-Style-Type" content="text/css">
<title>Tools Documentation</title>
<link rel="stylesheet" href="http://tomoyo.sourceforge.jp/tomoyo.css" media="all" type="text/css">
</head>
<body>
<p style="text-align:right;"><a href="tools-doc.html.ja">Japanese Page</a></p>
<p style="text-align:right;">Last modified: $Date$</p>
<h1>Tools Documentation</h1>

<hr>

<h2><a name="administration_tool">&lt;&lt;Tools for system administrators&gt;&gt;</a></h2>

<h3><a name="ccs-editpolicy">&lt;Policy Editor "ccs-editpolicy"&gt;</a></h3>
<p>Edits the current policy in /proc/ccs/ directory.</p>
<p>You may give one of 'e' 'd' 'p' 'm' 's' to the commandline to choose the initial screen. If not given, screen for domain listing is shown.</p>
<p>You can use keys listed below.</p>

<p>&lt;Scroll&gt;</p>
<table border="1">
<tr><td>Up-arrow</td><td>Scroll 1 line up.</td></tr>
<tr><td>Down-arrow</td><td>Scroll 1 line down.</td></tr>
<tr><td>PageUp</td><td>Scroll 1 page up.</td></tr>
<tr><td>PageDown</td><td>Scroll 1 page down.</td></tr>
<tr><td>Right-arrow</td><td>Scroll 1 column right.</td></tr>
<tr><td>Left-arrow</td><td>Scroll 1 column left.</td></tr>
<tr><td>Home</td><td>Move to the top of line.</td></tr>
<tr><td>End</td><td>Move to the bottom of line.</td></tr>
</table>

<p>&lt;Search&gt;</p>
<table border="1">
<tr><td>f/F</td><td>Find First</td></tr>
<tr><td>n/N</td><td>Find Next</td></tr>
<tr><td>p/P</td><td>Find Previous</td></tr>
</table>

<p>&lt;Edit&gt;</p>
<table border="1">
<tr><td>a/A</td><td>Add an entry.</td></tr>
<tr><td>Enter</td><td>Edit ACLs of a domain at the cursor position. (Valid only for screen for domain listing.)</td></tr>
<tr><td>Space</td><td>Invert selection state of an entry at the cursor position.</td></tr>
<tr><td>c/C</td><td>Copy selection state of an entry at the cursor position to all entries below the cursor position.</td></tr>
<tr><td>d/D</td><td>Delete selected entries.</td></tr>
<tr><td>s/S</td><td>Set profile number of selected entries. (Valid only for screen for domain listing.)<br>
Set profile value for selected entries. (Valid only for screen for profile editing)<br>
Set new quota value for selected entries. (Valid only for screen for memory usage)</td></tr>
<tr><td>Insert</td><td>Copy an entry at the cursor position to history buffer.</td></tr>
</table>

<p>&lt;Misc&gt;</p>
<table border="1">
<tr><td>q/Q</td><td>Quit</td></tr>
<tr><td>r/R</td><td>Refresh</td></tr>
<tr><td>w/W</td><td>Switch to window list.</td></tr>
</table>

<p>A tutorial is available at <a href="tool-editpolicy.html.en">How to use Policy Editor</a>.</p>

<h3><a name="ccs-loadpolicy">&lt;Policy Loader "ccs-loadpolicy"&gt;</a></h3>
<p>Reads policy from standard input and writes to /proc/ccs/ interface.</p>
<p>There are the following commandline parameters.</p>
<ul>
<li>-e --- Append to /proc/ccs/exception_policy .
<li>-d --- Append to /proc/ccs/domain_policy .
<li>-ef --- Overwrite /proc/ccs/exception_policy .
<li>-df --- Overwrite /proc/ccs/domain_policy .
<li>-p --- Append to /proc/ccs/profile .
<li>-m --- Append to /proc/ccs/manager .
<li>-s --- Append to /proc/ccs/stat .
</ul>

<h3><a name="ccs-setlevel">&lt;Control Level Changer "ccs-setlevel"&gt;</a></h3>
<p>Changes the current control level (i.e. writing to /proc/ccs/profile ) and displays the new control level.</p>
<p>You can give the new control level from commandline parameter.</p>

<h3><a name="ccs-setprofile">&lt;Profile Selector "ccs-setprofile"&gt;</a></h3>
<p>Assigns a profile to domains.</p>
<p>You can give the new profile number and domainnames from the commandline parameter. The list of domainnames that the profile number assigned to has changed is printed.</p>

<h3><a name="ccs-pstree">&lt;Process Info Viewer "ccs-pstree"&gt;</a></h3>
<p>Lists the domainnames of currently running processes belong to and the profile numbers the domains currently assigned to.</p>
<p>This program shows the profile number, the name of process, PID, the domainname like "pstree" command.</p>

<h3><a name="ccs-savepolicy">&lt;Policy Saver "ccs-savepolicy"&gt;</a></h3>
<p>Saves the on-memory policy onto disk.</p>
<p>There are the following commandline parameters.</p>
<ul>
<li>-e --- Print /proc/ccs/exception_policy .
<li>-d --- Print /proc/ccs/domain_policy .
<li>-p --- Print /proc/ccs/profile .
<li>-m --- Print /proc/ccs/manager .
<li>-s --- Print /proc/ccs/stat .
</ul>

<h3><a name="ccs-auditd">&lt;Access Log Reading Daemon "ccs-auditd"&gt;</a></h3>
<p>Reads from /proc/ccs/audit and writes to the location specified in /etc/ccs/tools/auditd.conf . The number of logs that the kernel will keep is given using profile's PREFERENCE={ max_audit_log=integer } lines.</p>
<p>This program runs as a daemon. You can start from /etc/rc.d/rc.local if you are using RedHat Linux. If you needn't to save access logs, you needn't to run this program.</p>

<h3><a name="ccs-sortpolicy">&lt;Access Log Compressor "ccs-sortpolicy"&gt;</a></h3>
<p>Remove duplicated entry from logs written by "ccs-auditd".</p>
<p>Reads logs written by "ccs-auditd" from standard input and sorts by domains and removes duplicated entries and writes to standard output.</p>

<h3><a name="ccs-findtemp">&lt;Temporal Pathnames Detector "ccs-findtemp"&gt;</a></h3>
<p>Reads domain policy from standard input and checks the existence of pathnames, and dumps the nonexistent pathnames.</p>
<p>The nonexistent pathnames are likely used as temporary pathnames. So find the naming rules from similar nonexistent pathnames and append the pattern to /etc/ccs/exception_policy.conf and /proc/ccs/exception_policy .</p>
<p>You can pass the content of /etc/ccs/domain_policy.conf or /proc/ccs/domain_policy using redirection or pipes to the standard input of this program.</p>

<h3><a name="ccs-queryd">&lt;Delayed Enforcing Mode Handler "ccs-queryd"&gt;</a></h3>
<p>Detects policy violation and displays the access request. You can tell the system whether the access request should be granted (or granted and policy should be appended to grant the access request) or rejected after you validate the access request.</p>
<p>By running this program while updating packages, you can avoid errors due to insufficient permissions.</p>
<p>Never grant access requests unconditionally. The cause of policy violation is not always updating packages, but may by malicious requests by attackers. If you grant access requests caused by malicious requests by attackers, the system gets intruded.</p>

<h3><a name="ccs-notifyd">&lt;Policy Violation Notifyier "ccs-notifyd"&gt;</a></h3>
<p>Detects policy violation and take some actions (e.g. send a mail) to notify it to the administrator.</p>

<h3><a name="ccs-checkpolicy">&lt;Policy Syntax Checker "ccs-checkpolicy"&gt;</a></h3>
<p>Reads policy files from standard input and checks syntaxes.</p>
<p>Prints errors with line numbers if any.</p>

<h3><a name="ccs-init">&lt;Initial Policy Loader "ccs-init"&gt;</a></h3>
<p>Loads policy files from /etc/ccs/ directory.</p>
<p>Put this program as /sbin/ccs-init and execute this program by passing init=/sbin/ccs-init to the kernel's boot parameter.</p>

<h3><a name="ccs-domainmatch">&lt;ACL Searcher "ccs-domainmatch"&gt;</a></h3>
<p>This is a "fgrep" for /proc/ccs/domain_policy .</p>

<h3><a name="ccs-patternize">&lt;Pathname Pattern Replacer "ccs-patternize"&gt;</a></h3>
<p>Reads domain policy from standard input and replaces pathnames with patterns if the pathname matches patterns specified in /etc/ccs/tools/patternize.conf  and writes to standard output. Domainnames won't be patterned.</p>

<h3><a name="init_policy">&lt;Policy Template Generator "init_policy"&gt;</a></h3>
<p>Generates templates for policy. You need to review the output because automatically generated policy may contain redundant or dangerous entries.</p>

<h3><a name="audit-exec-param">&lt;A program for auditing execute parameter "audit-exec-param"&gt;</a></h3>
<p>This program writes parameters passed to execve() to syslog before actually executes the execve() request.</p>
<p>You can copy this program to somewhere before use (e.g. cp -p /usr/lib/ccs/audit-exec-param /bin/audit-exec-param). For example, to audit execve() parameters passed to Apache's CGI program, tell the kernel not to transit domains when executing /bin/audit-exec-param by adding "keep_domain /usr/lib/ccs/audit-exec-param from &lt;kernel&gt; /usr/sbin/httpd" in the exception policy, and add "execute_handler /bin/audit-exec-param" to the Apache's domain (e.g. "&lt;kernel&gt; /usr/sbin/httpd" domain).</p>

<hr>

<h2><a name="authentication_tool">&lt;&lt;Tools for reinforcing login authentications&gt;&gt;</a></h2>

<h3><a name="falsh">&lt;Restricted login shell for authentication "falsh"&gt;</a></h3>
<p>A tiny shell that has no built-in command such as "kill". You can use this program for login shell ( the shell specified in the /etc/passwd file). You won't need this program if you don't want to reinforce login authentications.</p>
<p>You should make your own programs for additional authentications. You shouldn't use the following example programs without modifications.</p>

<h3><a name="honey">&lt;An example program for password authentication with timings "honey"&gt;</a></h3>
<p>This program fails unless the correct password is typed with the correct time interval. Conventional authentication programs don't check the time interval of typing, but this program does to prevent password brute force attack.</p>

<h3><a name="candy">&lt;An example program for password authentication with time limit "candy"&gt;</a></h3>
<p>This program fails unless the correct password is typed and this program was invoked within 10 seconds after the parent process was invoked. Conventional authentication programs don't check the time interval between the invocation time of parent process and the invocation time of child process, but this program does to prevent password brute force attack.</p>

<h3><a name="groovy">&lt;An example program for lockfile authentication "groovy"&gt;</a></h3>
<p>This program fails while the file /tmp/.lockme exists. This program prompts for password, but doesn't check for password. This program checks for the existence of the file /tmp/.lockme . This program prevents password brute force attack by keeping locked just before you run this program. This is a program for demonstration, and using a filename that are apparent to crackers. You must customize if you want to use.</p>

<h3><a name="checktoken">&lt;An example program for token authentication "gettoken / checktoken"&gt;</a></h3>
<p>This program generates tokens based on the system time. The authentication will succeed if the output of "gettoken" is passwd to the input of "checktoken". These are programs for demonstration, and the algorithm is too poor. You must customize if you want to use.</p>

<h3><a name="chaplet">&lt;An example program for challenge-handshake authentication "chaplet"&gt;</a></h3>
<p>This program displays strings as a challenge data. The authentication will succeed if you input only numerical letters from the challenge data as a response data. This is a program for demonstration, and the algorithm is too poor. You must customize if you want to use.</p>

<h3><a name="timeauth">&lt;An example program for password authentication with timings  "timeauth"&gt;</a></h3>
<p>This is a re-implementation of "honey". Create a script and specify this program as the interpreter for the script.</p>

<h3><a name="mailauth">&lt;An example program for one-time-password authentication using mail "mailauth"&gt;</a></h3>
<p>This program generates one time password and sends it to the user using "mail". The authentication will succeed if the user input the password sent by "mail". To use this program, some mail server application is needed.</p>

<h3><a name="proxy">&lt;A simple port forwarder "proxy"&gt;</a></h3>
<p>This program is used by client side. This program explicitly binds to local port and connects to server so that the server side firewall (such as "iptables") can use packet filtering based on client side's port number.</p>

<hr>

<p><a href="index.html.en">Return to index page.</a></p>
<p><a href="http://sourceforge.jp/"><img src="http://sourceforge.jp/sflogo.php?group_id=5310" width="96" height="31" alt="SourceForge.jp"></a></p>
</body>
</html>
